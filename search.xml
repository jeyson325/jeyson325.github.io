<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>webpack中url-loader新版本的坑（变化）</title>
    <url>/2020/12/14/webpack%E4%B8%ADurl-loader%E6%96%B0%E7%89%88%E6%9C%AC%E7%9A%84%E5%9D%91%EF%BC%88%E5%8F%98%E5%8C%96%EF%BC%89/</url>
    <content><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>之前在进行webpack配置练习过程中遇到了一个坑，花了2个小时才搞定，挺有感触，以记之。</p>
<p>webpack有几个核心概念，其中一个是loader。</p>
<p>loader其实就是用于对模块的源代码进行转换，如TypeScript转换为 JavaScript，sass转成css等，就要安装相对应的 loader。</p>
<p>其中有几个常用的loader如下：</p>
<a id="more"></a>

<ul>
<li>处理图片、字体等文件<code>file-loader</code>或者<code>url-loader</code>。（file-loader可以对图片、字体等文件进行打包，url-loader是基于file-loader进行的一层封装，可以将限制在大小以内的图片文件转成base64格式，减少图片请求）</li>
<li>处理vue文件<code>vue-loader</code>（详见vue-loader文档）</li>
<li>处理css文件<code>css-loader</code>、<code>style-loader</code></li>
<li>处理scss文件<code>sass-loader</code>、<code>node-sass</code></li>
<li>处理vue文件里的style <code>vue-style-loader</code></li>
<li>css预处理<code>postcss-loader</code></li>
<li>…</li>
</ul>
<h3 id="url-loader新版本的坑"><a href="#url-loader新版本的坑" class="headerlink" title="url-loader新版本的坑"></a>url-loader新版本的坑</h3><p>我把将图片和字体资源放进项目，根据webpack的官方文档介绍安装了<code>file-loader</code>和<code>url-loader</code>，进行配置并加载，此时出问题了。</p>
<p>通过<code>file-loader</code>加载的字体正常，<strong>而通过<code>url-loader</code>加载的图片却出不来。</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gai032c55hj30pu082t9c.jpg" alt="image-20200101214727561"></p>
<p>开始以为是配置出的错误，经过反复的尝试修改，结果一无所获。</p>
<p>于是去网上找了一个别人的webpack相关项目拉下来运行，但很奇怪的是， <strong>url-loader</strong>相关的配置，大家基本都差不多按文档来的，那为啥别人的图片就能运行成功，到我这里就加载失败了？</p>
<h3 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h3><p>经过反复的比对分析，一点点排除错误因素，终于找到了问题所在——<code>url-loader</code>版本问题。</p>
<p>通过npm-check-updates，我检查到package.json里面的版本变化：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gai03k9m3oj30pu0f875y.jpg" alt="image-20200101221638094"></p>
<p>这里面最大的变化就是<code>file-loader</code>和<code>url-loader</code>，是一个大版本的更新。</p>
<p>但是项目中字体解析正常，那么<strong>问题很可能就出在<code>url-loader</code>上。</strong></p>
<p>于是我去github上查看<code>url-loader</code>的更新日志，看看都更新了什么，结果看到了这个：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gai03qz5hkj31240h0whb.jpg" alt="image-20200101222340289"></p>
<p>翻译过来就是：</p>
<ul>
<li>最低要求的nodejs版本是10.13.0</li>
<li>将esModules选项重命名为esModule</li>
<li>默认情况下切换到ES模块（<strong>默认情况下，esModule选项为true</strong>）</li>
</ul>
<p>那么一切就水落石出了：最新版本的 <code>url-loader</code> 添加了一个新的配置选择 <strong>esModule</strong>。</p>
<p>如果不设置 <strong>esModule</strong> 为 <strong>false</strong>，那么默认它会将图片导出一个module对象，而不是一个url路径，所以此时页面图片当然加载不出来了。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.js </span></span><br><span class="line"><span class="comment">// 入口文件 引入图片和logo</span></span><br><span class="line"><span class="keyword">const</span> happy = <span class="built_in">require</span>(<span class="string">&#x27;./happy.jpg&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> logo = <span class="built_in">require</span>(<span class="string">&#x27;./logo.png&#x27;</span>)</span><br><span class="line"><span class="comment">// 注: url-loader在3.0.0版本有重大改变</span></span><br><span class="line"><span class="comment">// 需在webpack.config.js里添加 esModule: false</span></span><br><span class="line"><span class="comment">// 否则打印出来的happy是个module对象，不是一个url路径</span></span><br><span class="line"><span class="built_in">console</span>.log(happy)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// 加载图片</span></span><br><span class="line">    test: <span class="regexp">/\.(png|jpg|gif|svg)$/</span>,</span><br><span class="line">    use: [</span><br><span class="line">      &#123;</span><br><span class="line">        loader: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">5</span> * <span class="number">1024</span>,</span><br><span class="line">          name: <span class="string">&#x27;images/[name].[ext]&#x27;</span>,</span><br><span class="line">          <span class="comment">// 如果要在图片的src里使用，这里要添加esModule属性，默认是true，需要设置成false</span></span><br><span class="line">          esModule: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>注：而<strong>关于<code>url-loader</code>最近的这次更新，webpack中文文档上面并没有同步更新</strong>，仍然只有以前的三个options配置选项，我去翻英文文档，才发现它更新了。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li><strong>不仅仅是webpack，许多项目的中文文档都不是及时更新的，有一定的滞后性，要习惯看英文文档，看英文文档，看英文文档！！！</strong></li>
<li>爬坑的过程，也是快速深入学习的过程，爬完之后对webpack相关配置理解了很多。</li>
</ul>
]]></content>
      <categories>
        <category>技术</category>
      </categories>
      <tags>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>前言：我平淡生活的最后目击者</title>
    <url>/2020/12/12/%E5%89%8D%E8%A8%80%EF%BC%9A%E6%88%91%E5%B9%B3%E6%B7%A1%E7%94%9F%E6%B4%BB%E7%9A%84%E6%9C%80%E5%90%8E%E7%9B%AE%E5%87%BB%E8%80%85/</url>
    <content><![CDATA[<p>今年的大部分时间里，我一个人住在距离上班的地方仅10分钟路程的公寓里，每天会经过两个红绿灯，在第二个路口处拐弯，可以看到一排枫树，从左往右用脚步数过去，大概300多步就会到达公司楼下，然后掏出钉钉打卡。</p>
<p>所以我几乎不会迟到，因为实在太近了，以至于我可以精确的将打卡时间卡在8点59分这个节点上而游刃有余，堪称卡点狂魔。</p>
<a id="more"></a>

<p>生活作息也因此变得极其规律，晚上基本12点左右睡觉，早上可以睡到自然醒，然后煮点东西去洗漱。吃完早饭后带上一杯枸杞，慢悠悠的步行到公司。</p>
<p>工作任务并不算繁重，随着技术的沉淀和积累，我在处理项目问题时越来越得心应手。工作时常常会屏蔽所有消息，戴上耳机，陷入到专注开发的快乐中而无法自拔。</p>
<p>每天基本上就是朝九晚六，没啥娱乐活动，也懒得花费时间去社交，于是造成了一种愈发想远离人群的孤独感。</p>
<p>由于住得近，我下班后吃完晚饭通常不到8点，之后我有将近4个小时的时间可以自由安排，我可以在这段时间里选择看书、写东西、练琴、健身、敲代码、看综艺和洗澡。</p>
<p>有时候也会熬夜，比如看喜欢的节目、沉迷于代码等等，那第二天基本会被8点半的闹钟吵醒，然后赶紧起来洗漱，并顶着乱糟糟的头发一路狂奔，带着枸杞杯中的水一路跑一路撒。</p>
<p>每天过得就像云朵一般轻柔、平淡，如一阵风拂过。</p>
<p>风来来去去，日子也就过去了。</p>
<p>最近两年里，我的性格谈不上大变，但也潜移默化的改变了很多。也是在这两年里，我才真心觉得自己是个大人了，从心底认可自己已不再年轻。</p>
<p>从小到大，都在习惯被别人照顾、被年长的照顾，当我开始想照顾别人的时候，成长在慢慢发芽。</p>
<p>我开始走着无数前人走过的路，去关注柴米油盐，想拼命攒钱 ，也不再轻易就谈出发，而是理解人情世故，三思而行。</p>
<p>有些道理就在忽如一夜春风来中开了花，像是从身体血液里长出来一样鲜红。</p>
<p>去年有一段时间像着魔了一样疯狂的抢时间学习，上厕所的时候学，睡醒的时候学，走路的时候学，一直持续数月，直到有一天晚上学到头昏脑胀，恶心想吐，闭着眼躺在床上陷入长久的黑暗。我那时想，与时间赛跑的夸父是不是就是这样倒下的？自嘲之后，还是爬起来继续学。</p>
<p>倒是谈不上辛苦，自己和自己做斗争罢了。</p>
<p>我在25岁之前都茫然不知所谓，看不到前路何在，空洞的想法多，欲望多，而脚踏实地的行动少，才能也不足，说是喜欢读书，实际并不怎么读书，性子无趣又乏味，每天就陷在无意义的琐碎小事上，如井底之蛙，安于一隅。</p>
<p>醒过来后，大好青春已消耗殆尽，时间一去不复返。无论后来怎么弥补，总有些事会充满遗憾。</p>
<p>我时常想，如果以前换一种选择，是不是结果会不一样？我推演了很多种结局，但最终发现，只要消除现在的记忆，无论在青春时做出哪一种选择，大概率都将殊途同归。</p>
<p>思想不变，视野不变，环境不变，何以能改变命运？</p>
<p>所以有些悲欢离合是无法避免的，我只能用付出青春的代价去试错，去一点点改变自己。</p>
<p>这两年我开始专注于对自身的投资，去学新的技术、学游泳、练琴、养花，我享受到其中源源不断的乐趣，也借此躲避现实的繁碎嘈杂，渐渐的找到了一种平衡内心的全新生活方式。</p>
<p>我发现工作、金钱、虚荣、生活……它们都只是过程而已，最终都将成为我了解自己、认识自己、构造自己，从而追寻自我意义的养分。</p>
<p>现在我还是无法改变很多事情，但我知道了自己的天赋和软弱，我可以选择在未来想要成为的人，我知道要如何一步步走到那里，我喜欢为改变所做的一切。</p>
<p>我决定着手搭建博客了。</p>
<p>我想把这几年积累的一些编程问题和笔记整理汇总一下，修建自己思维的小花园，沉淀技术。此外还准备加入日常生活的点滴成长，记录一些喜爱的小东西。</p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwly1gll5kmqrc5j31my0l0q68.jpg" alt="image-20201206215848085"></p>
<p>文字、技术、柴米油盐、冬天的橘子和夏天的西瓜，这些东西大致组成了我生活的核心要素。我想把它们记录下来，在以后的某个时刻，通过这些痕迹，就可以一脚踏进时间的长河，沿河而上，追溯到此时的心情，找到隐藏在记忆桥底下真正生活状态的滚滚洪流。</p>
<p>子曰，朝闻道，夕死可矣。</p>
<p>既然有幸看到了这个广阔世界的漫天星光，就想要去试试看。有些事还是想要做的，有些遗憾还是想弥补的。</p>
<p>而且，记录时我会思考，思考让我活着，这就是我的意义。</p>
<p>我是我平淡生活最后的目击者。</p>
]]></content>
      <categories>
        <category>生活</category>
      </categories>
  </entry>
</search>
